(()=>{"use strict";let e=[],t=[];class o{static getLocalProjectList(){let e=localStorage.getItem("localProjectList");return e=JSON.parse(e),e}static getLocalNodeList(){let t=localStorage.getItem("localNodeList"),c=[];t=JSON.parse(t);let a=0;return t.forEach((t=>{const r=document.createElement("template");r.innerHTML=t.trim();const s=r.content.firstChild,d=new n(e[a].name,e[a].list);s.addEventListener("click",(()=>{i.loadTodosToPage(d),i.checkSelectedProject()})),s.querySelector(".edit-project").addEventListener("click",(e=>{e.stopPropagation(),i.displayPopUp("projectRename","",d),i.loadProjectsToPage()})),s.querySelector(".delete-project").addEventListener("click",(e=>{e.stopPropagation(),o.removeProject(d),document.querySelector(".project-container").innerHTML="",o.removeNode(s),i.loadProjectsToPage(),i.checkSelectedProject()})),a++,c.push(s)})),c}static setLocalProjectList(e){localStorage.setItem("localProjectList",JSON.stringify(e))}static setLocalNodeList(e){let t=[];e.forEach((e=>{t.push(e.outerHTML)})),localStorage.setItem("localNodeList",JSON.stringify(t))}static addProject(t){e.push(t),this.setLocalProjectList(e)}static removeProject(t){const o=this.findProject(t);-1!=o&&e.splice(o,1),this.setLocalProjectList(e)}static removeTodo(t,o){const n=this.findTodo(t,o);o.list.splice(n,1),this.setLocalProjectList(e)}static addNode(e){t.push(e),this.setLocalNodeList(t)}static removeNode(e){const o=t.findIndex((t=>t.textContent==e.textContent));-1!=o&&t.splice(o,1),this.setLocalNodeList(t)}static findProject(t){return e.findIndex((e=>e.name==t.name))}static findTodo(e,t){return t.list.findIndex((t=>t.title==e.title))}static renameProject(o,n){let c;if(""!=n){if(e.forEach((e=>{if(e.name==n)return c=!0,void i.displayPopUp("errorCreation","A project under this name already exists.")})),!c){const c=this.findProject(o);e[c].name=n,t[c].firstChild.textContent=n,this.setLocalProjectList(e),this.setLocalNodeList(t)}}else i.displayPopUp("errorCreation","The new name must not be empty.")}static editTodo(t,o,n,c,a,r){let s,d=o.list.findIndex((e=>e.title==n));if(-1!=d&&(i.displayPopUp("errorCreation","A todo under this name already exists."),s=!0),""!=n){if(!s){const i=this.findTodo(t,o);return o.list[i].title=n,o.list[i].description=c,o.list[i].dueDate=a,o.list[i].priority=r,void this.setLocalProjectList(e)}}else i.displayPopUp("errorCreation","The todo name must not be empty.")}}document.addEventListener("DOMContentLoaded",(()=>{localStorage.localProjectList?(e=o.getLocalProjectList(),t=o.getLocalNodeList()):(localStorage.localProjectList=[],localStorage.localNodeList=[]),i.loadProjectsToPage()}));class n{constructor(e,t=[]){this.name=e,this.list=t}getName(){return this.name}setName(e){this.name=e}addTodo(t){this.list.push(t),o.setLocalProjectList(e)}}class c{constructor(e,t,o,n=1){this.title=e,this.description=t,this.dueDate=o,this.priority=n,this.checked=!1}getTitle(){return this.title}getDescription(){return this.description}getDate(){return this.dueDate}getPriority(){return this.priority}checkTodo(){0!=this.checked?this.checked=!1:this.checked=!0}}class i{static addProjectToPage(e){const t=document.createElement("li"),n=document.createElement("span"),c=document.createElement("i");c.classList.add("material-icons","edit-project"),c.innerHTML="edit",c.addEventListener("click",(()=>{i.displayPopUp("projectRename","",e),this.loadProjectsToPage(),this.checkSelectedProject()}));const a=document.createElement("i");a.classList.add("material-icons","delete-project"),a.innerHTML="delete",a.addEventListener("click",(()=>{o.removeProject(e),document.querySelector(".project-container").innerHTML="",o.removeNode(t),this.loadProjectsToPage(),this.checkSelectedProject()})),t.classList.add("project"),n.textContent=e.name,n.addEventListener("click",(t=>{t.stopPropagation(),this.loadTodosToPage(e),this.checkSelectedProject()})),t.appendChild(n),t.appendChild(c),t.appendChild(a),o.addNode(t),this.loadProjectsToPage()}static loadProjectsToPage(){l.innerHTML="",t.forEach((e=>{l.appendChild(e)}))}static loadTodosToPage(e){d.innerHTML="";const t=document.createElement("div"),o=document.createElement("div"),n=document.createElement("h2"),c=document.createElement("span"),i=document.createElement("span");i.textContent="add_circle",i.classList.add("material-icons","add-todo","md-48"),i.addEventListener("click",(()=>{this.displayPopUp("todoCreation","",e)})),n.textContent=e.name,c.textContent=`Todo count: ${e.list.length}`,n.appendChild(c),t.classList.add("project-info-container"),t.append(n),d.append(t),o.classList.add("todos-container"),this.createTodoNodes(e).forEach((e=>{o.appendChild(e)})),d.appendChild(o),d.append(i)}static createTodoNodes(e){const t=[];return e.list.forEach((n=>{const c=document.createElement("div"),i=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),s=document.createElement("h3"),d=document.createElement("span"),l=document.createElement("p");c.classList.add("todo-container"),c.addEventListener("click",(()=>{this.displayPopUp("viewTodo","","",n)})),i.classList.add("todo-header"),i.classList.add(`todo-priority-${n.priority}`),a.classList.add("todo-content"),r.classList.add("action-container"),s.textContent=n.title,d.classList.add("todo-date"),d.textContent=n.dueDate,l.textContent=n.description;const p=document.createElement("i");p.classList.add("material-icons","edit-todo"),p.innerHTML="edit",p.addEventListener("click",(t=>{t.stopPropagation(),this.displayPopUp("todoEdit","",e,n)}));const u=document.createElement("i");u.classList.add("material-icons","delete-todo"),u.innerHTML="delete",u.addEventListener("click",(t=>{t.stopPropagation(),o.removeTodo(n,e),this.loadTodosToPage(e)}));const m=document.createElement("input");m.setAttribute("type","checkbox"),1==n.checked&&m.setAttribute("checked","true"),m.addEventListener("click",(e=>{e.stopPropagation()})),m.addEventListener("change",(e=>{n.checkTodo(),this.adjustTodoStyling(s,d,l,i,c,n)})),this.adjustTodoStyling(s,d,l,i,c,n),r.append(m,p,u),i.append(s,d),a.append(l,r),c.append(i,a),t.push(c)})),t}static adjustTodoStyling(e,t,o,n,c,i){if(1==i.checked){switch(e.style.textDecoration="line-through",t.style.textDecoration="line-through",o.style.textDecoration="line-through",i.priority){case"1":n.style.backgroundColor="rgba(103, 103, 245, 0.4)";break;case"2":n.style.backgroundColor="rgba(48, 48, 173, 0.4)";break;case"3":n.style.backgroundColor="rgba(29, 29, 143, 0.4)"}c.style.backgroundColor="rgba(220, 226, 230, 0.4)"}else{switch(e.style.textDecoration="",t.style.textDecoration="",o.style.textDecoration="",i.priority){case"1":n.style.backgroundColor="var(--font-secondary)";break;case"2":n.style.backgroundColor="rgb(21, 21, 128)";break;case"3":n.style.backgroundColor="rgb(3, 3, 63)"}c.style.backgroundColor="rgba(220, 226, 230, 1)"}}static displayPopUp(t,a,s,d){this.dimSite();const l=document.createElement("div");l.classList.add("popup-container");const p=document.createElement("h2"),u=document.createElement("div");u.classList.add("button-container");const m=document.createElement("button");m.textContent="CANCEL",m.addEventListener("click",this.hidePopUp),m.addEventListener("click",this.undimSite);const h=document.createElement("input");h.setAttribute("type","text");const L=document.createElement("button");switch(L.textContent="SUBMIT",L.addEventListener("click",this.undimSite),L.addEventListener("click",this.hidePopUp),t){case"projectCreation":p.textContent="Add Project",h.setAttribute("placeholder","Enter the project name..."),L.addEventListener("click",(()=>{(t=>{let c;if(e.forEach((e=>{e.name==t&&(i.displayPopUp("errorCreation","The project under this name already exists."),c=!0)})),""!=t){if(!c){const e=new n(t);o.addProject(e),i.addProjectToPage(e)}}else i.displayPopUp("errorCreation","The project name must not be empty.")})(h.value)})),u.append(L),l.append(p,h,u);break;case"todoCreation":p.textContent="Add Todo",h.setAttribute("placeholder","Title...");const t=document.createElement("input");t.setAttribute("placeholder","Description...");const r=document.createElement("div");r.classList.add("small-input-holder");const P=document.createElement("input");P.setAttribute("type","date");const E=document.createElement("div"),y=document.createElement("label");y.setAttribute("for","priority"),y.textContent="Priority";const j=document.createElement("input");j.setAttribute("type","number"),j.setAttribute("value","1"),j.setAttribute("id","priority"),j.setAttribute("min","1"),j.setAttribute("max","3"),j.addEventListener("keypress",(e=>{e.preventDefault()})),E.append(y,j),r.append(P,E),L.addEventListener("click",(()=>{((e,t,o,n,a)=>{let r;if(-1!=t.list.findIndex((t=>t.title==e))&&(i.displayPopUp("errorCreation","A todo under this name already exists."),r=!0),""!=e){if(!r){""==o&&(o="No description...");const r=new c(e,o,n,a);t.addTodo(r),i.loadTodosToPage(t)}}else i.displayPopUp("errorCreation","The todo name must not be empty.")})(h.value,s,t.value,P.value,j.value),this.loadTodosToPage(s)})),u.append(L),l.append(p,h,t,r,u);break;case"projectRename":p.textContent="Rename Project",h.setAttribute("placeholder","Enter the new project name..."),L.addEventListener("click",(()=>{o.renameProject(s,h.value)})),u.append(L),l.append(p,h,u);break;case"todoEdit":p.textContent="Edit Todo",h.setAttribute("placeholder","Title...");const v=document.createElement("input");v.setAttribute("placeholder","Description...");const g=document.createElement("input");g.setAttribute("type","date");const T=document.createElement("div"),b=document.createElement("label");b.setAttribute("for","priority"),b.textContent="Priority";const C=document.createElement("input");C.setAttribute("type","number"),C.setAttribute("value","1"),C.setAttribute("id","priority"),C.setAttribute("min","1"),C.setAttribute("max","3"),C.addEventListener("keypress",(e=>{e.preventDefault()})),T.append(b,C);const k=document.createElement("div");k.classList.add("small-input-holder"),k.append(g,T),L.addEventListener("click",(()=>{o.editTodo(d,s,h.value,v.value,g.value,C.value),this.loadTodosToPage(s)})),u.append(L),l.append(p,h,v,k,u);break;case"errorCreation":p.textContent="Error";const x=document.createElement("p");x.textContent=a,l.append(p,x),l.classList.add("popup-error");break;case"viewTodo":p.textContent=d.title;const f=document.createElement("p");f.textContent=d.description;const S=document.createElement("span");S.textContent=`Due date: ${d.dueDate}`;const A=document.createElement("span");A.textContent=`Priority: ${d.priority}`,m.textContent="OK",l.append(p,f,S,A)}u.append(m),l.append(u),r.appendChild(l)}static checkSelectedProject(){if(""==d.innerHTML){const e=document.createElement("p");e.textContent="Nothing to view. No project selected.",d.append(e),d.classList.add("no-project")}else d.classList.remove("no-project")}static hidePopUp(){document.querySelector(".popup-container").remove()}static dimSite(){s.classList.add("dim")}static undimSite(){s.classList.remove("dim")}}const a=document.querySelector("#project-adder"),r=(document.querySelector(".delete-project"),document.querySelector("body")),s=document.querySelector(".site-container"),d=document.querySelector(".project-container"),l=(document.querySelector(".content-container"),document.querySelector("#project-list"));a.addEventListener("click",(()=>{i.displayPopUp("projectCreation")})),i.checkSelectedProject()})();